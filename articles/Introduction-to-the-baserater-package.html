<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the baserater package • baserater</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the baserater package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">baserater</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction-to-the-baserater-package.html">Introduction to the baserater package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the baserater package</h1>
            
      

      <div class="hidden name"><code>Introduction-to-the-baserater-package.Rmd</code></div>

    </div>

    
    
<p>The <code>baserater</code> package allows you to:</p>
<ul>
<li>Download a database of group–adjective pairs annotated with
stereotype strength scores generated by large language models (GPT-4 and
LLaMA 3.3);<br>
</li>
<li>Generate new typicality ratings using a Hugging Face language model
of your choice, with customizable prompts and parameters;<br>
</li>
<li>Evaluate newly generated typicality ratings against human ground
truth (ratings collected from Prolific participants) and benchmark them
against baseline models;<br>
</li>
<li>Automatically build a new base-rate item database from a group x
description typicality matrix.</li>
</ul>
<p>It is designed to streamline the creation of base-rate neglect items
for reasoning experiments. You can use it to generate new typicality
ratings with any LLM on the Hugging Face platform using your own prompts
and parameters, benchmark these ratings against human data, and
construct a base-rate item dataset from the generated scores.</p>
<p>To learn more about the theoretical framework and validation studies
underlying the <code>baserater</code> package, see the paper: <em>Using
Large Language Models to Estimate Belief Strength in Reasoning</em>
(Beucler et al., Forthcoming).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jeremie-beucler.github.io/baserater/" class="external-link">baserater</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="downloading-the-data">1. Downloading the Data<a class="anchor" aria-label="anchor" href="#downloading-the-data"></a>
</h2>
<p>You can begin by downloading the article datasets using
<code><a href="../reference/download_data.html">download_data()</a></code>.</p>
<p>Use <code><a href="../reference/download_data.html">download_data()</a></code> to retrieve either: - The full
base-rate item database (from GPT-4 and LLaMA 3.3); - The validation
ratings, which include human typicality scores and those generated by
GPT-4 and LLaMA 3.3 on 100 group–adjective pairs. - The two typicality
matrices (from GPT-4 and LLaMA 3.3) that were used to generate the
base-rate item database.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the base-rate database</span></span>
<span><span class="va">database</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_data.html">download_data</a></span><span class="op">(</span><span class="st">"database"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the typicality validation ratings</span></span>
<span><span class="va">ratings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_data.html">download_data</a></span><span class="op">(</span><span class="st">"validation_ratings"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the typicality matrices</span></span>
<span><span class="va">gpt4_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_data.html">download_data</a></span><span class="op">(</span><span class="st">"typicality_matrix_gpt4"</span><span class="op">)</span></span>
<span><span class="va">llama3_3_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_data.html">download_data</a></span><span class="op">(</span><span class="st">"typicality_matrix_llama3.3"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generating-new-typicality-ratings-from-llms">2. Generating New Typicality Ratings from LLMs<a class="anchor" aria-label="anchor" href="#generating-new-typicality-ratings-from-llms"></a>
</h2>
<p>You can generate new typicality ratings using a Hugging Face-hosted
language model via <code><a href="../reference/generate_typicality.html">generate_typicality()</a></code>. Note that this is
an experimental feature, as it depends on API and model compatibility.
See the <a href="#hugging-face-resources">Hugging Face Resources</a>
section at the end of this vignette for more information on how to set
up your Hugging Face account and API token.</p>
<p>The function works by sending structured prompts to a large language
model and parsing numeric outputs (between 0 and 100) that reflect how
well a description (e.g., an adjective) fits a given group. By default,
the function uses the same prompt and generation parameters described in
the paper.</p>
<p>Here is an example of how the function call might look:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Original prompt from the paper</span></span>
<span><span class="va">original_system_prompt_content</span> <span class="op">&lt;-</span> <span class="st">"You are expert at accurately reproducing the stereotypical associations humans make, in order to annotate data for experiments. Your focus is to capture common societal perceptions and stereotypes, rather than factual attributes of the groups, even when they are negative or unfounded."</span></span>
<span></span>
<span><span class="va">original_user_prompt_content_template</span> <span class="op">&lt;-</span> <span class="st">'Rate how well the adjective "{description}" reflects the prototypical member of the group "{group}" on a scale from 0 ("Not at all") to 100 ("Extremely").</span></span>
<span><span class="st"></span></span>
<span><span class="st">To clarify, consider the following examples:</span></span>
<span><span class="st"></span></span>
<span><span class="st">1. "Rate how well the adjective "FUNNY" reflects the prototypical member of the group "CLOWN" on a scale from 0 (Not at all) to 100 (Extremely)." A high rating is expected because the adjective "FUNNY" closely aligns with the typical characteristics of a "CLOWN".</span></span>
<span><span class="st"></span></span>
<span><span class="st">2. "Rate how well the adjective "FEARFUL" reflects the prototypical member of the group "FIREFIGHTER" on a scale from 0 (Not at all) to 100 (Extremely)." A low rating is expected because the adjective "FEARFUL" diverges significantly from the typical characteristics of a "FIREFIGHTER".</span></span>
<span><span class="st"></span></span>
<span><span class="st">3. "Rate how well the adjective "PATIENT" reflects the prototypical member of the group "ENGINEER" on a scale from 0 (Not at all) to 100 (Extremely)." A mid-scale rating is expected because the adjective "PATIENT" neither closely aligns nor diverges significantly from the typical characteristics of an "ENGINEER".</span></span>
<span><span class="st"></span></span>
<span><span class="st">Your response should be a single score between 0 and 100, with no additional text, letters, or symbols included.'</span></span>
<span></span>
<span><span class="co"># Llama 3 Formatted Prompts</span></span>
<span><span class="co"># see https://www.llama.com/docs/model-cards-and-prompt-formats/llama3_1/</span></span>
<span><span class="co"># These special tags are required for models in the LLaMA 3 family</span></span>
<span><span class="va">llama3_system_prompt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"&lt;|begin_of_text|&gt;"</span>,</span>
<span>  <span class="st">"&lt;|start_header_id|&gt;system&lt;|end_header_id|&gt;\n\n"</span>,</span>
<span>  <span class="va">original_system_prompt_content</span>,</span>
<span>  <span class="st">"\n&lt;|eot_id|&gt;"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">llama3_user_prompt_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"&lt;|start_header_id|&gt;user&lt;|end_header_id|&gt;\n\n"</span>,</span>
<span>  <span class="va">original_user_prompt_content_template</span>,</span>
<span>  <span class="st">"\n&lt;|eot_id|&gt;"</span>,</span>
<span>  <span class="st">"&lt;|start_header_id|&gt;assistant&lt;|end_header_id|&gt;\n\n"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example using the validation ratings</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="va">ratings</span><span class="op">$</span><span class="va">group</span></span>
<span><span class="va">descriptions</span> <span class="op">&lt;-</span> <span class="va">ratings</span><span class="op">$</span><span class="va">adjective</span></span>
<span></span>
<span><span class="va">hf_token</span> <span class="op">=</span> <span class="st">"YOUR TOKEN HERE"</span> <span class="co"># default = Sys.getenv("HF_API_TOKEN")</span></span>
<span></span>
<span><span class="va">new_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_typicality.html">generate_typicality</a></span><span class="op">(</span></span>
<span>  groups                <span class="op">=</span> <span class="va">groups</span>,</span>
<span>  descriptions          <span class="op">=</span> <span class="va">descriptions</span>,</span>
<span>  model                 <span class="op">=</span> <span class="st">"meta-llama/Llama-3.1-8B-Instruct"</span>,</span>
<span>  hf_token              <span class="op">=</span> <span class="va">hf_token</span>,</span>
<span>  system_prompt         <span class="op">=</span> <span class="va">llama3_system_prompt</span>,</span>
<span>  user_prompt_template  <span class="op">=</span> <span class="va">llama3_user_prompt_template</span>,</span>
<span>  n                     <span class="op">=</span> <span class="fl">3</span>, <span class="co"># number of responses to generate</span></span>
<span>  min_valid             <span class="op">=</span> <span class="fl">2</span>, <span class="co"># minimum number of valid responses, we take the average</span></span>
<span>  max_tokens            <span class="op">=</span> <span class="fl">3</span>, <span class="co"># for numeric output between 0 and 100</span></span>
<span>  retries               <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  matrix                <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_raw_scores     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_full_responses <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose               <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here is what the output would look like. Note that we also get the
occasional error messages from the Hugging Face API since we set
<code>return_full_responses</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">new_scores</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="2%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="93%">
</colgroup>
<thead><tr class="header">
<th align="left">group</th>
<th align="left">description</th>
<th align="right">mean_score</th>
<th align="left">raw_scores</th>
<th align="left">full_responses</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DJ</td>
<td align="left">naive</td>
<td align="right">56</td>
<td align="left">56, 56, 56</td>
<td align="left">56, 56, 56</td>
</tr>
<tr class="even">
<td align="left">accountant</td>
<td align="left">solitary</td>
<td align="right">58</td>
<td align="left">58, 58, 58</td>
<td align="left">58, 58, 58</td>
</tr>
<tr class="odd">
<td align="left">actor</td>
<td align="left">altruistic</td>
<td align="right">74</td>
<td align="left">74, 74, 74</td>
<td align="left">74, 74, 74</td>
</tr>
<tr class="even">
<td align="left">aerobics instructor</td>
<td align="left">impulsive</td>
<td align="right">42</td>
<td align="left">42, 42</td>
<td align="left">API_CALL_ERROR: Error in
httr2::req_perform(httr2::req_retry(httr2::req_timeout(httr2::req_body_json(httr2::req_headers(httr2::request(url),
: Failed to perform HTTP request.  [1mCaused by error in
<code><a href="https://jeroen.r-universe.dev/curl/reference/curl_fetch.html" class="external-link">curl::curl_fetch_memory()</a></code>: [22m  [33m! [39m Timeout was
reached [api-inference.huggingface.co]: Operation timed out after 60002
milliseconds with 0 bytes received , 42 , 42</td>
</tr>
<tr class="odd">
<td align="left">architect</td>
<td align="left">charismatic</td>
<td align="right">22</td>
<td align="left">22, 22, 22</td>
<td align="left">22, 22, 22</td>
</tr>
<tr class="even">
<td align="left">architect</td>
<td align="left">reserved</td>
<td align="right">85</td>
<td align="left">85, 85, 85</td>
<td align="left">85, 85, 85</td>
</tr>
</tbody>
</table>
<p>We can also look at the distribution of the new typicality ratings
generated by LLaMA 3.1-8B-Instruct:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Distribution of new typicality ratings</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">new_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">5</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribution of Typicality Ratings from LLaMA 3.1-8B-Instruct"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Typicality Rating"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction-to-the-baserater-package_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The <code><a href="../reference/generate_typicality.html">generate_typicality()</a></code> function supports two
modes:</p>
<ul>
<li>
<code>matrix = TRUE</code> (default): Computes a cross-product of
unique groups and descriptions. Returns a list with matrices of scores
and responses.<br>
</li>
<li>
<code>matrix = FALSE</code>: Computes row-by-row scores for the
group–adjective pairs you supply. Returns a tibble.</li>
</ul>
<p>See <code><a href="../reference/generate_typicality.html">?generate_typicality</a></code> for full documentation and
customization options.</p>
</div>
<div class="section level2">
<h2 id="evaluating-new-ratings">3. Evaluating New Ratings<a class="anchor" aria-label="anchor" href="#evaluating-new-ratings"></a>
</h2>
<p>You can then assess how well a new model or scoring method captures
group–adjective typicality by comparing your ratings to the human ground
truth and benchmark models (GPT-4 and LLaMA 3.3).</p>
<p>To do that, you need typicality ratings for the 100 validation items
stored in a data frame with three columns: group, adjective, and rating.
We will use the <code>new_scores</code> data frame we generated
earlier.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a data frame with the same structure as the validation set</span></span>
<span><span class="va">new_scores</span> <span class="op">=</span> <span class="va">new_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>adjective <span class="op">=</span> <span class="va">description</span>,</span>
<span>         rating <span class="op">=</span> <span class="va">mean_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">adjective</span>, <span class="va">rating</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">new_scores</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">group</th>
<th align="left">adjective</th>
<th align="right">rating</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DJ</td>
<td align="left">naive</td>
<td align="right">56</td>
</tr>
<tr class="even">
<td align="left">accountant</td>
<td align="left">solitary</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td align="left">actor</td>
<td align="left">altruistic</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">aerobics instructor</td>
<td align="left">impulsive</td>
<td align="right">42</td>
</tr>
<tr class="odd">
<td align="left">architect</td>
<td align="left">charismatic</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">architect</td>
<td align="left">reserved</td>
<td align="right">85</td>
</tr>
</tbody>
</table>
<p>First, let’s examine the correlation between the new scores and the
human ratings visually:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join human and model scores</span></span>
<span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>  <span class="va">ratings</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">adjective</span>, human <span class="op">=</span> <span class="va">mean_human_rating</span><span class="op">)</span>,</span>
<span>  <span class="va">new_scores</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span>, <span class="st">"adjective"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scatterplot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">comparison_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rating</span>, y <span class="op">=</span> <span class="va">human</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of LLaMA 3.1 and Human Typicality Ratings"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Average Human Rating"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Average LLaMA 3.1 Rating"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction-to-the-baserater-package_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Use <code><a href="../reference/evaluate_external_ratings.html">evaluate_external_ratings()</a></code> to compute correlations
and display comparisons with our LLMs baseline:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print correlation summary with human ground truth and baselines</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/evaluate_external_ratings.html">evaluate_external_ratings</a></span><span class="op">(</span><span class="va">new_scores</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">model</th>
<th align="right">r</th>
<th align="right">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">external</td>
<td align="right">0.5049062</td>
<td align="right">1e-07</td>
</tr>
<tr class="even">
<td align="left">mean_gpt4_rating</td>
<td align="right">0.8848219</td>
<td align="right">0e+00</td>
</tr>
<tr class="odd">
<td align="left">mean_llama3_rating</td>
<td align="right">0.8179981</td>
<td align="right">0e+00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optionally store the output in a variable</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_external_ratings.html">evaluate_external_ratings</a></span><span class="op">(</span><span class="va">new_scores</span><span class="op">)</span></span></code></pre></div>
<p>As you can see, the smaller and older Llama-3.1-8B-Instruct does not
perform as our baseline models (GPT-4 and LLaMA 3.3-70B).</p>
</div>
<div class="section level2">
<h2 id="constructing-base-rate-items-from-typicality-matrices">4. Constructing Base-Rate Items from Typicality Matrices<a class="anchor" aria-label="anchor" href="#constructing-base-rate-items-from-typicality-matrices"></a>
</h2>
<p>To compute stereotype strength using
<code><a href="../reference/extract_base_rate_items.html">extract_base_rate_items()</a></code>, you’ll need a typicality
matrix—a table of scores where rows correspond to groups and columns
correspond to descriptions (e.g., adjectives). Each cell represents how
typical a description is for a group.</p>
<p>For example, you can load the GPT-4 typicality matrix using
download_data() (the same is available for LLaMA 3.3):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' The typicality matrix from GPT-4 is a data frame with group–adjective pairs and their typicality scores</span></span>
<span><span class="va">gpt4_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_data.html">download_data</a></span><span class="op">(</span><span class="st">"typicality_matrix_gpt4"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gpt4_matrix</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="3%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="2%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="2%">
</colgroup>
<thead><tr class="header">
<th align="left">X</th>
<th align="right">intelligent</th>
<th align="right">arrogant</th>
<th align="right">nerdy</th>
<th align="right">kind</th>
<th align="right">loud</th>
<th align="right">careful</th>
<th align="right">argumentative</th>
<th align="right">persuasive</th>
<th align="right">immature</th>
<th align="right">active</th>
<th align="right">funny</th>
<th align="right">disorganized</th>
<th align="right">dishonest</th>
<th align="right">gentle</th>
<th align="right">sensitive</th>
<th align="right">creative</th>
<th align="right">helpful</th>
<th align="right">strong</th>
<th align="right">brave</th>
<th align="right">bossy</th>
<th align="right">unconventional</th>
<th align="right">quiet</th>
<th align="right">organized</th>
<th align="right">reliable</th>
<th align="right">ambitious</th>
<th align="right">charming</th>
<th align="right">confident</th>
<th align="right">efficient</th>
<th align="right">friendly</th>
<th align="right">generous</th>
<th align="right">naive</th>
<th align="right">witty</th>
<th align="right">empathetic</th>
<th align="right">stubborn</th>
<th align="right">trustworthy</th>
<th align="right">meticulous</th>
<th align="right">inventive</th>
<th align="right">charismatic</th>
<th align="right">reserved</th>
<th align="right">altruistic</th>
<th align="right">original</th>
<th align="right">impulsive</th>
<th align="right">zealous</th>
<th align="right">rational</th>
<th align="right">idealistic</th>
<th align="right">conservative</th>
<th align="right">solitary</th>
<th align="right">passionate</th>
<th align="right">adventurous</th>
<th align="right">cautious</th>
<th align="right">extravagant</th>
<th align="right">jovial</th>
<th align="right">cooperative</th>
<th align="right">attractive</th>
<th align="right">muscular</th>
<th align="right">shy</th>
<th align="right">social</th>
<th align="right">warm</th>
<th align="right">moody</th>
<th align="right">lazy</th>
<th align="right">hardworking</th>
<th align="right">imaginative</th>
<th align="right">narrow.minded</th>
<th align="right">boring</th>
<th align="right">selfish</th>
<th align="right">narcissistic</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">farmer</td>
<td align="right">55.00</td>
<td align="right">15.20</td>
<td align="right">11.6</td>
<td align="right">75.32</td>
<td align="right">13.8</td>
<td align="right">84.04</td>
<td align="right">21.20</td>
<td align="right">25.6</td>
<td align="right">12.60</td>
<td align="right">88.20</td>
<td align="right">22.4</td>
<td align="right">20.6</td>
<td align="right">14.20</td>
<td align="right">63.08</td>
<td align="right">34.80</td>
<td align="right">38.80</td>
<td align="right">80.00</td>
<td align="right">88.0</td>
<td align="right">70.60</td>
<td align="right">19.80</td>
<td align="right">20.8</td>
<td align="right">71.40</td>
<td align="right">83.8</td>
<td align="right">85.44</td>
<td align="right">50.40</td>
<td align="right">33.6</td>
<td align="right">74.60</td>
<td align="right">79.32</td>
<td align="right">79.60</td>
<td align="right">65.6</td>
<td align="right">28.80</td>
<td align="right">29.6</td>
<td align="right">48.80</td>
<td align="right">71.80</td>
<td align="right">84.4</td>
<td align="right">71.00</td>
<td align="right">53.40</td>
<td align="right">28.4</td>
<td align="right">67.8</td>
<td align="right">62.60</td>
<td align="right">37.2</td>
<td align="right">19.60</td>
<td align="right">51.6</td>
<td align="right">76.80</td>
<td align="right">34.60</td>
<td align="right">80.60</td>
<td align="right">74.80</td>
<td align="right">75.2</td>
<td align="right">31.60</td>
<td align="right">77.80</td>
<td align="right">10.0</td>
<td align="right">61.40</td>
<td align="right">79.4</td>
<td align="right">31.00</td>
<td align="right">78.0</td>
<td align="right">26.40</td>
<td align="right">33.20</td>
<td align="right">70.40</td>
<td align="right">22.20</td>
<td align="right">10.20</td>
<td align="right">91.00</td>
<td align="right">32.6</td>
<td align="right">36.24</td>
<td align="right">38.00</td>
<td align="right">17.80</td>
<td align="right">10.20</td>
</tr>
<tr class="even">
<td align="left">computer programmer</td>
<td align="right">90.28</td>
<td align="right">57.80</td>
<td align="right">85.2</td>
<td align="right">42.20</td>
<td align="right">13.4</td>
<td align="right">84.40</td>
<td align="right">30.20</td>
<td align="right">33.4</td>
<td align="right">32.96</td>
<td align="right">28.40</td>
<td align="right">25.0</td>
<td align="right">35.0</td>
<td align="right">19.20</td>
<td align="right">37.08</td>
<td align="right">33.00</td>
<td align="right">74.00</td>
<td align="right">54.80</td>
<td align="right">25.8</td>
<td align="right">22.60</td>
<td align="right">21.40</td>
<td align="right">71.2</td>
<td align="right">76.20</td>
<td align="right">82.2</td>
<td align="right">83.00</td>
<td align="right">81.00</td>
<td align="right">26.4</td>
<td align="right">69.20</td>
<td align="right">86.16</td>
<td align="right">42.28</td>
<td align="right">35.4</td>
<td align="right">19.60</td>
<td align="right">42.8</td>
<td align="right">33.20</td>
<td align="right">66.00</td>
<td align="right">70.2</td>
<td align="right">84.60</td>
<td align="right">85.92</td>
<td align="right">26.6</td>
<td align="right">79.2</td>
<td align="right">30.80</td>
<td align="right">72.6</td>
<td align="right">20.60</td>
<td align="right">73.4</td>
<td align="right">86.52</td>
<td align="right">33.00</td>
<td align="right">36.20</td>
<td align="right">80.00</td>
<td align="right">75.6</td>
<td align="right">26.20</td>
<td align="right">76.60</td>
<td align="right">15.6</td>
<td align="right">22.20</td>
<td align="right">51.8</td>
<td align="right">28.40</td>
<td align="right">14.8</td>
<td align="right">74.68</td>
<td align="right">32.00</td>
<td align="right">24.32</td>
<td align="right">43.20</td>
<td align="right">26.80</td>
<td align="right">85.00</td>
<td align="right">70.4</td>
<td align="right">29.40</td>
<td align="right">66.40</td>
<td align="right">25.20</td>
<td align="right">24.60</td>
</tr>
<tr class="odd">
<td align="left">flight attendant</td>
<td align="right">50.20</td>
<td align="right">27.68</td>
<td align="right">11.4</td>
<td align="right">84.00</td>
<td align="right">21.2</td>
<td align="right">83.92</td>
<td align="right">20.72</td>
<td align="right">39.0</td>
<td align="right">15.60</td>
<td align="right">84.44</td>
<td align="right">30.8</td>
<td align="right">16.6</td>
<td align="right">15.40</td>
<td align="right">77.00</td>
<td align="right">73.32</td>
<td align="right">30.80</td>
<td align="right">86.88</td>
<td align="right">34.4</td>
<td align="right">40.72</td>
<td align="right">36.60</td>
<td align="right">26.0</td>
<td align="right">31.00</td>
<td align="right">87.8</td>
<td align="right">82.80</td>
<td align="right">36.20</td>
<td align="right">75.0</td>
<td align="right">82.80</td>
<td align="right">82.40</td>
<td align="right">85.40</td>
<td align="right">48.2</td>
<td align="right">17.72</td>
<td align="right">49.0</td>
<td align="right">77.20</td>
<td align="right">20.60</td>
<td align="right">81.8</td>
<td align="right">80.40</td>
<td align="right">24.00</td>
<td align="right">73.4</td>
<td align="right">30.4</td>
<td align="right">59.04</td>
<td align="right">24.2</td>
<td align="right">21.32</td>
<td align="right">56.6</td>
<td align="right">69.40</td>
<td align="right">21.20</td>
<td align="right">29.80</td>
<td align="right">14.00</td>
<td align="right">58.2</td>
<td align="right">70.28</td>
<td align="right">73.96</td>
<td align="right">19.0</td>
<td align="right">74.08</td>
<td align="right">86.0</td>
<td align="right">79.60</td>
<td align="right">18.4</td>
<td align="right">18.20</td>
<td align="right">85.60</td>
<td align="right">78.20</td>
<td align="right">30.40</td>
<td align="right">15.00</td>
<td align="right">86.60</td>
<td align="right">26.4</td>
<td align="right">16.00</td>
<td align="right">19.72</td>
<td align="right">18.08</td>
<td align="right">21.60</td>
</tr>
<tr class="even">
<td align="left">high school coach</td>
<td align="right">63.60</td>
<td align="right">64.20</td>
<td align="right">14.4</td>
<td align="right">64.40</td>
<td align="right">75.2</td>
<td align="right">74.68</td>
<td align="right">64.20</td>
<td align="right">83.4</td>
<td align="right">20.52</td>
<td align="right">88.40</td>
<td align="right">40.8</td>
<td align="right">29.8</td>
<td align="right">27.16</td>
<td align="right">36.40</td>
<td align="right">35.32</td>
<td align="right">56.40</td>
<td align="right">85.20</td>
<td align="right">86.0</td>
<td align="right">71.00</td>
<td align="right">79.68</td>
<td align="right">26.8</td>
<td align="right">23.52</td>
<td align="right">79.0</td>
<td align="right">78.60</td>
<td align="right">79.44</td>
<td align="right">39.8</td>
<td align="right">85.08</td>
<td align="right">69.80</td>
<td align="right">74.44</td>
<td align="right">64.8</td>
<td align="right">19.60</td>
<td align="right">42.2</td>
<td align="right">65.20</td>
<td align="right">72.60</td>
<td align="right">75.2</td>
<td align="right">61.80</td>
<td align="right">49.40</td>
<td align="right">76.0</td>
<td align="right">29.6</td>
<td align="right">70.08</td>
<td align="right">38.4</td>
<td align="right">36.40</td>
<td align="right">81.6</td>
<td align="right">73.40</td>
<td align="right">54.24</td>
<td align="right">69.00</td>
<td align="right">20.00</td>
<td align="right">86.6</td>
<td align="right">61.60</td>
<td align="right">70.80</td>
<td align="right">16.8</td>
<td align="right">71.00</td>
<td align="right">79.8</td>
<td align="right">40.72</td>
<td align="right">81.4</td>
<td align="right">17.00</td>
<td align="right">77.52</td>
<td align="right">64.48</td>
<td align="right">32.72</td>
<td align="right">25.20</td>
<td align="right">84.80</td>
<td align="right">41.4</td>
<td align="right">48.48</td>
<td align="right">34.28</td>
<td align="right">28.84</td>
<td align="right">32.48</td>
</tr>
<tr class="odd">
<td align="left">dentist</td>
<td align="right">85.92</td>
<td align="right">39.88</td>
<td align="right">23.8</td>
<td align="right">60.80</td>
<td align="right">10.4</td>
<td align="right">90.60</td>
<td align="right">18.80</td>
<td align="right">53.6</td>
<td align="right">11.08</td>
<td align="right">37.80</td>
<td align="right">20.0</td>
<td align="right">15.4</td>
<td align="right">22.52</td>
<td align="right">75.40</td>
<td align="right">39.80</td>
<td align="right">35.12</td>
<td align="right">81.40</td>
<td align="right">29.6</td>
<td align="right">30.60</td>
<td align="right">30.40</td>
<td align="right">19.2</td>
<td align="right">70.20</td>
<td align="right">88.0</td>
<td align="right">85.60</td>
<td align="right">69.80</td>
<td align="right">33.2</td>
<td align="right">84.80</td>
<td align="right">83.40</td>
<td align="right">69.40</td>
<td align="right">35.6</td>
<td align="right">11.60</td>
<td align="right">26.2</td>
<td align="right">53.88</td>
<td align="right">26.64</td>
<td align="right">81.6</td>
<td align="right">89.60</td>
<td align="right">31.00</td>
<td align="right">35.0</td>
<td align="right">63.6</td>
<td align="right">36.00</td>
<td align="right">27.6</td>
<td align="right">18.00</td>
<td align="right">37.2</td>
<td align="right">85.00</td>
<td align="right">19.20</td>
<td align="right">52.40</td>
<td align="right">35.52</td>
<td align="right">55.8</td>
<td align="right">21.80</td>
<td align="right">86.20</td>
<td align="right">27.0</td>
<td align="right">26.00</td>
<td align="right">72.8</td>
<td align="right">37.60</td>
<td align="right">18.2</td>
<td align="right">20.80</td>
<td align="right">36.80</td>
<td align="right">33.40</td>
<td align="right">20.48</td>
<td align="right">14.28</td>
<td align="right">86.32</td>
<td align="right">29.4</td>
<td align="right">17.76</td>
<td align="right">65.08</td>
<td align="right">26.68</td>
<td align="right">20.80</td>
</tr>
<tr class="even">
<td align="left">lawyer</td>
<td align="right">85.20</td>
<td align="right">74.28</td>
<td align="right">33.0</td>
<td align="right">33.80</td>
<td align="right">39.6</td>
<td align="right">83.40</td>
<td align="right">83.80</td>
<td align="right">88.6</td>
<td align="right">18.00</td>
<td align="right">73.80</td>
<td align="right">20.4</td>
<td align="right">20.2</td>
<td align="right">69.40</td>
<td align="right">26.40</td>
<td align="right">29.60</td>
<td align="right">43.60</td>
<td align="right">47.80</td>
<td align="right">68.4</td>
<td align="right">33.40</td>
<td align="right">70.20</td>
<td align="right">22.4</td>
<td align="right">26.20</td>
<td align="right">86.0</td>
<td align="right">64.60</td>
<td align="right">87.60</td>
<td align="right">35.4</td>
<td align="right">87.00</td>
<td align="right">74.60</td>
<td align="right">36.00</td>
<td align="right">31.2</td>
<td align="right">14.20</td>
<td align="right">69.0</td>
<td align="right">32.80</td>
<td align="right">70.80</td>
<td align="right">42.0</td>
<td align="right">83.88</td>
<td align="right">46.00</td>
<td align="right">69.2</td>
<td align="right">40.2</td>
<td align="right">28.60</td>
<td align="right">39.8</td>
<td align="right">25.28</td>
<td align="right">74.0</td>
<td align="right">84.80</td>
<td align="right">27.80</td>
<td align="right">61.68</td>
<td align="right">34.00</td>
<td align="right">70.6</td>
<td align="right">30.80</td>
<td align="right">83.00</td>
<td align="right">66.2</td>
<td align="right">20.80</td>
<td align="right">47.8</td>
<td align="right">41.52</td>
<td align="right">16.2</td>
<td align="right">18.60</td>
<td align="right">63.32</td>
<td align="right">22.20</td>
<td align="right">30.40</td>
<td align="right">19.80</td>
<td align="right">85.20</td>
<td align="right">37.6</td>
<td align="right">31.40</td>
<td align="right">62.20</td>
<td align="right">71.00</td>
<td align="right">67.60</td>
</tr>
</tbody>
</table>
<p>Extract base-rate items by applying the function:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Extract base-rate items from the typicality matrix</span></span>
<span><span class="va">base_rate_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_base_rate_items.html">extract_base_rate_items</a></span><span class="op">(</span><span class="va">gpt4_matrix</span><span class="op">)</span></span></code></pre></div>
<p>You can then explore or filter the output, e.g., to view the
strongest stereotypes:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View top base-rate items by stereotype strength</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">base_rate_items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">StereotypeStrength</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="24%">
<col width="19%">
<col width="14%">
<col width="8%">
<col width="8%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="left">Group1</th>
<th align="left">Group2</th>
<th align="left">Description</th>
<th align="right">Score1</th>
<th align="right">Score2</th>
<th align="right">StereotypeStrength</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">fashion designer</td>
<td align="left">paramedic</td>
<td align="left">extravagant</td>
<td align="right">82.80</td>
<td align="right">8.0</td>
<td align="right">2.336987</td>
</tr>
<tr class="even">
<td align="left">fashion model</td>
<td align="left">paramedic</td>
<td align="left">extravagant</td>
<td align="right">79.60</td>
<td align="right">8.0</td>
<td align="right">2.297573</td>
</tr>
<tr class="odd">
<td align="left">music producer</td>
<td align="left">paramedic</td>
<td align="left">extravagant</td>
<td align="right">78.04</td>
<td align="right">8.0</td>
<td align="right">2.277780</td>
</tr>
<tr class="even">
<td align="left">hippy</td>
<td align="left">fitness trainer</td>
<td align="left">lazy</td>
<td align="right">72.00</td>
<td align="right">7.4</td>
<td align="right">2.275186</td>
</tr>
<tr class="odd">
<td align="left">drummer</td>
<td align="left">librarian</td>
<td align="left">loud</td>
<td align="right">83.60</td>
<td align="right">8.6</td>
<td align="right">2.274281</td>
</tr>
<tr class="even">
<td align="left">politician</td>
<td align="left">fitness trainer</td>
<td align="left">lazy</td>
<td align="right">71.44</td>
<td align="right">7.4</td>
<td align="right">2.267378</td>
</tr>
<tr class="odd">
<td align="left">politician</td>
<td align="left">paramedic</td>
<td align="left">extravagant</td>
<td align="right">76.00</td>
<td align="right">8.0</td>
<td align="right">2.251292</td>
</tr>
<tr class="even">
<td align="left">DJ</td>
<td align="left">librarian</td>
<td align="left">loud</td>
<td align="right">81.20</td>
<td align="right">8.6</td>
<td align="right">2.245153</td>
</tr>
<tr class="odd">
<td align="left">aerobics instructor</td>
<td align="left">librarian</td>
<td align="left">loud</td>
<td align="right">80.60</td>
<td align="right">8.6</td>
<td align="right">2.237736</td>
</tr>
<tr class="even">
<td align="left">politician</td>
<td align="left">paramedic</td>
<td align="left">selfish</td>
<td align="right">83.64</td>
<td align="right">9.0</td>
<td align="right">2.229297</td>
</tr>
</tbody>
</table>
<p>You can also subset the database to focus on a specific adjective or
group. For example, you can visualize the stereotype strength of the
adjective “selfish” across group combinations:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pick one adjective and extract group typicality scores</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">gpt4_matrix</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">selfish</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">X</span>, score <span class="op">=</span> <span class="va">selfish</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span><span class="op">)</span>  <span class="co"># sort by how typical the group is</span></span>
<span></span>
<span><span class="co"># Save group names and their scores</span></span>
<span><span class="va">group_order</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">group</span></span>
<span><span class="va">typ_values</span>  <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">score</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">typ_values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">group</span></span>
<span></span>
<span><span class="co"># Build all group pairs and compute log-ratios</span></span>
<span><span class="va">res_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  g1 <span class="op">=</span> <span class="va">group_order</span>,</span>
<span>  g2 <span class="op">=</span> <span class="va">group_order</span>,</span>
<span>  KEEP.OUT.ATTRS <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    typ1 <span class="op">=</span> <span class="va">typ_values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    typ2 <span class="op">=</span> <span class="va">typ_values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    log_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">typ1</span>, <span class="fl">1e-9</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">typ2</span>, <span class="fl">1e-9</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">g1</span>, levels <span class="op">=</span> <span class="va">group_order</span><span class="op">)</span>,</span>
<span>    g2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">g2</span>, levels <span class="op">=</span> <span class="va">group_order</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Keep only pairs where g1 is ranked higher than g2 and log-ratio is positive</span></span>
<span><span class="va">res_df</span> <span class="op">&lt;-</span> <span class="va">res_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span>, <span class="va">log_ratio</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add identity pairs (g1 == g2) with NA</span></span>
<span><span class="va">diag_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">group_order</span>, levels <span class="op">=</span> <span class="va">group_order</span><span class="op">)</span>,</span>
<span>  g2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">group_order</span>, levels <span class="op">=</span> <span class="va">group_order</span><span class="op">)</span>,</span>
<span>  log_ratio <span class="op">=</span> <span class="cn">NA_real_</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine with original filtered upper-triangle pairs</span></span>
<span><span class="va">res_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">res_df</span>, <span class="va">diag_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the heatmap</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">g2</span>, y <span class="op">=</span> <span class="va">g1</span>, fill <span class="op">=</span> <span class="va">log_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>    low       <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>    mid       <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    high      <span class="op">=</span> <span class="st">"firebrick"</span>,</span>
<span>    midpoint  <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    na.value  <span class="op">=</span> <span class="st">"grey90"</span>,</span>
<span>    name      <span class="op">=</span> <span class="st">"Log(Group 1 / Group 2)"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Stereotype Strength for Adjective 'Selfish'"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Group 2"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Group 1"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">15</span>, hjust <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    panel.grid  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Introduction-to-the-baserater-package_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="section level3">
<h3 id="hugging-face-resources">Hugging Face Resources<a class="anchor" aria-label="anchor" href="#hugging-face-resources"></a>
</h3>
<p>Hugging Face is a platform that provides access to a wide range of
pre-trained models and datasets for natural language processing (NLP)
tasks. The <code>baserater</code> package uses Hugging Face’s API to
generate typicality scores with various models. Here are some useful
resources to get started with Hugging Face:</p>
<ul>
<li>
<a href="https://huggingface.co/settings/tokens" class="external-link">Create a Hugging
Face access token</a> — Required to authenticate API requests to hosted
models.<br>
</li>
<li>
<a href="https://huggingface.co/docs/inference-endpoints" class="external-link">Hugging
Face Inference Endpoints</a> — Set up and deploy your own scalable model
endpoint directly through Hugging Face.<br>
</li>
<li>
<a href="https://huggingface.co/docs/inference-providers" class="external-link">Hugging
Face Inference Providers</a> — Use third-party infrastructure (e.g.,
AWS, Azure, Paperspace) to serve and scale models.<br>
</li>
<li>
<a href="https://huggingface.co/models" class="external-link">Hugging Face Model Hub</a> —
Browse available models (e.g., LLaMA, Mixtral) and view license
requirements.</li>
</ul>
<p>If you’d like to generate new scores yourself using the
<code><a href="../reference/generate_typicality.html">generate_typicality()</a></code> function, make sure you’ve completed
the following setup steps:</p>
<ul>
<li><p>Create a Hugging Face account and generate an API token:<br>
You can either pass it directly to the <code>hf_token</code> argument of
the function, or store it as an environment variable in R (e.g., use
<code>Sys.setenv(HF_API_TOKEN = "your_token")</code>).</p></li>
<li><p>Accept the model’s terms of use:<br>
Before using certain models (e.g., LLaMA), you must agree to their
license terms on the Hugging Face Model Hub.</p></li>
<li><p>Ensure your prompt matches the model’s expected input
format:<br>
Some models require special formatting, such as instruction tags or
system prompts. Check the model card on Hugging Face for
details.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jeremie Beucler.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
